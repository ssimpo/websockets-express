{"version":3,"file":"websocket-express.development.js","sources":["node_modules/lodash-es/_arrayPush.js","node_modules/lodash-es/_freeGlobal.js","node_modules/lodash-es/_root.js","node_modules/lodash-es/_Symbol.js","node_modules/lodash-es/_getRawTag.js","node_modules/lodash-es/_objectToString.js","node_modules/lodash-es/_baseGetTag.js","node_modules/lodash-es/isObjectLike.js","node_modules/lodash-es/_baseIsArguments.js","node_modules/lodash-es/isArguments.js","node_modules/lodash-es/isArray.js","node_modules/lodash-es/_isFlattenable.js","node_modules/lodash-es/isObject.js","node_modules/lodash-es/isFunction.js","node_modules/lodash-es/_coreJsData.js","node_modules/lodash-es/_isMasked.js","node_modules/lodash-es/_toSource.js","node_modules/lodash-es/_baseIsNative.js","node_modules/lodash-es/_getValue.js","node_modules/lodash-es/_getNative.js","node_modules/lodash-es/_nativeCreate.js","node_modules/lodash-es/_hashDelete.js","node_modules/lodash-es/_listCacheClear.js","node_modules/lodash-es/eq.js","node_modules/lodash-es/_Map.js","node_modules/lodash-es/_isKeyable.js","node_modules/lodash-es/_setCacheAdd.js","node_modules/lodash-es/_setCacheHas.js","node_modules/lodash-es/_baseFindIndex.js","node_modules/lodash-es/_baseIsNaN.js","node_modules/lodash-es/_strictIndexOf.js","node_modules/lodash-es/_arrayIncludesWith.js","node_modules/lodash-es/_cacheHas.js","node_modules/lodash-es/_Set.js","node_modules/lodash-es/noop.js","node_modules/lodash-es/_setToArray.js","node_modules/lodash-es/_createSet.js","src/util.js","src/browser.js"],"sourcesContent":["/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nexport default arrayPush;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nexport default baseIsArguments;\n","import baseIsArguments from './_baseIsArguments.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nexport default isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nexport default isArray;\n","import Symbol from './_Symbol.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\n\n/** Built-in value references. */\nvar spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\nexport default isFlattenable;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n","import baseGetTag from './_baseGetTag.js';\nimport isObject from './isObject.js';\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nexport default isFunction;\n","import root from './_root.js';\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nexport default coreJsData;\n","import coreJsData from './_coreJsData.js';\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nexport default isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nexport default toSource;\n","import isFunction from './isFunction.js';\nimport isMasked from './_isMasked.js';\nimport isObject from './isObject.js';\nimport toSource from './_toSource.js';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nexport default baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nexport default getValue;\n","import baseIsNative from './_baseIsNative.js';\nimport getValue from './_getValue.js';\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nexport default getNative;\n","import getNative from './_getNative.js';\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nexport default nativeCreate;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default hashDelete;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nexport default listCacheClear;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nexport default eq;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nexport default Map;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nexport default isKeyable;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nexport default setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nexport default setCacheHas;\n","/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default baseFindIndex;\n","/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nexport default baseIsNaN;\n","/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default strictIndexOf;\n","/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arrayIncludesWith;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nexport default cacheHas;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nexport default Set;\n","/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nexport default noop;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nexport default setToArray;\n","import Set from './_Set.js';\nimport noop from './noop.js';\nimport setToArray from './_setToArray.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n  return new Set(values);\n};\n\nexport default createSet;\n","import {isObject, isString, isNumber, isBoolean, uniq as unique, flatten} from 'lodash-es';\n\nconst chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz'.split('');\n\n\n/**\n * Generate a random integer between a start end end value.\n *\n * @param {integer} end\t\t\t\tThe start of the range.\n * @param {integer} [start=0]\t\tThe end of the range.\n * @returns {integer}\t\t\t\tRandom generated number.\n */\nexport function randomInt(end, start=0) {\n\treturn Math.floor(Math.random() * end) + start;\n}\n\n/**\n * Generate a randomstring.\n *\n * @param {integer} [length=32]\t\tThe length of string to generate.\n * @returns {string}\t\t\t\tRandom generated string.\n */\nexport function randomString(length=32) {\n\treturn (new Array(length)).fill(0).map(()=>chars[randomInt(chars.length - 1)]).join('');\n}\n\n/**\n * Get the length of a message object. Used to fake the content-length header in socket.io routes.\n *\n * @private\n * @param {*} message     Message to get length of.  This is assumed to be an object.\n * @returns {number}      Message length.\n */\nexport function getContentLength(message) {\n\ttry {\n\t\tif (isObject(message)) return JSON.stringify(message || {}).length.toString();\n\t\treturn message.toString().length.toString();\n\t} catch(err) {}\n\n\treturn \"1\";\n}\n\n/**\n * Define a defineProperty object for non-configurable property.\n *\n * @param {Object} instance\t\t\t\t\t\t\tInstance to do defineProperty on.\n * @param {string|Array.<string>} propertyName\t\tProperty name(s) to do defineProperty on.\n * @param {*} value\t\t\t\t\t\t\t\t\tThe property value to set.\n * @returns {Object}\t\t\t\t\t\t\t\tThe the instance for chaining purposes.\n */\nexport function definePropertyFixed(instance, propertyName, value) {\n\tmakeArray(propertyName).forEach((_propertyName, n)=>Object.defineProperty(instance, _propertyName, {\n\t\tconfigurable: false,\n\t\tenumerable: true,\n\t\tget: ()=>Array.isArray(propertyName)?value[n]:value,\n\t\tset: ()=>false\n\t}));\n\n\treturn instance;\n}\n\n/**\n * Define a defineProperty object for a standard enumerable, read/write property.\n *\n * @param {Object} instance\t\t\t\t\t\t\tInstance to do defineProperty on.\n * @param {string|Array.<string>} propertyName\t\tProperty name(s) to do defineProperty on.\n * @param {*} value\t\t\t\t\t\t\t\t\tThe property value to set.\n * @param {boolean} [configurable=false]\t\t\tIs this going to set the configurable property?\n * @returns {Object}\t\t\t\t\t\t\t\tThe the instance for chaining purposes.\n */\nexport function defineProperty(instance, propertyName, value, configurable=false) {\n\tmakeArray(propertyName).forEach((_propertyName, n)=>Object.defineProperty(instance, _propertyName, {\n\t\tconfigurable,\n\t\tenumerable: true,\n\t\twritable: true,\n\t\tvalue:Array.isArray(propertyName)?value[n]:value\n\t}));\n\n\treturn instance;\n}\n\n/**\n * Bind a given set of methods in one object to another object.\n *\n * @param {Object} takeFrom\t\t\tObject to bind methods in.\n * @param {Object} bindTo\t\t\tObject to bind each method to.\n * @param {Array} methods\t\t\tMethods to bind.\n * @returns {Object}\t\t\t\tThe takeFrom object for chaining.\n */\nexport function rebinder(takeFrom, bindTo, methods) {\n\tmakeArray(methods.methods).forEach(method=>{\n\t\tbindTo[method] = takeFrom[method].bind(bindTo);\n\t});\n\tmakeArray(methods.properties).forEach(property=>Object.defineProperty(bindTo, property, {\n\t\tget: ()=>takeFrom[property],\n\t\tset: value=>{takeFrom[property] = value}\n\t}));\n\n\treturn takeFrom;\n}\n\n/**\n * Turn the given value into an array.  If it is already an array then return it; if it is a set then convert to an\n * array; and if neither then return as the first item in an array. The purpose of this function is for function\n * or method parameters where they can be either a array or not.  You can use this to ensure you are working on\n * an array.\n *\n * @public\n * @param {Array|Set|*} value\t\tValue to return or convert.\n * @returns {Array}\t\t\t\t\tThe converted value (or original if already an array).\n */\nexport function makeArray(value) {\n\tif (value === undefined) return [];\n\tif (value instanceof Set) return [...value];\n\treturn (Array.isArray(value) ? value : [value]);\n}\n\nexport {isObject};\nexport {isString};\nexport {isNumber};\nexport {isBoolean};\nexport {unique};\nexport {flatten};","import {randomString} from \"./util\";\n\nlet buffer = window.buffer;\nlet ready = false;\nlet bson;\n\nconst afterReady = new Set();\nconst defaultSocketId = 'main';\nconst endpoints = new Map();\nconst callbacks = new Map();\nconst acknowledgements = new Map();\nconst sendQueue = new Map();\nconst sockets = new Map();\nconst serializers = new Map();\nconst deserializers = new Map();\nconst status = new Map();\nconst SOCKETSTATUS = Object.freeze({\n\tCONNECTING: 1,\n\tRECONNECTING: 2,\n\tCLOSED: 3,\n\tCONNECTED: 4\n});\n\nclass HTTP_ERROR extends Error {\n\tconstructor(message, ...params) {\n\t\tsuper(message.message,...params);\n\t\tthis.status = message.status;\n\t}\n}\n\n/**\n * Initiate this module, binding into all the correct global and framework points.\n */\nfunction init() {\n\tconst {\n\t\tjQuery=((!!window.$ && !!window.$.jQuery)?window.$:undefined),\n\t\tangular,\n\t\tbolt,\n\t\tdocument:doc\n\t\t} = window;\n\n\tif (!!jQuery) window.jQuery.websocket = new WebSocketService();\n\tif (!!angular) angular.module(\"websocket-express\", []).factory(\"$websocket\", ()=>new WebSocketService());\n\tif (!!bolt) {\n\t\tbolt.WebSocketService = WebSocketService;\n\t\tif (!!bolt.MODE && (bolt.MODE.has(\"DEVELOPMENT\") || bolt.MODE.has(\"DEBUG\"))) {\n\t\t\tbolt.WebSocketService.DEBUG = true;\n\t\t}\n\t}\n\n\tif (!!bolt && !!jQuery && !!angular) window.WebSocketService = WebSocketService;\n\n\t// This is extracted from jQuery.ready(), we want the works in all situations provided by jQuery without\n\t// the jQuery dependency. (@see https://github.com/jquery/jquery/blob/master/src/core/ready.js).\n\tfunction completed() {\n\t\tdocument.removeEventListener(\"DOMContentLoaded\", completed);\n\t\twindow.removeEventListener(\"load\", completed);\n\t\tonReady();\n\t}\n\n\tif (doc.readyState===\"complete\" || (doc.readyState !==\"loading\" && !doc.documentElement.doScroll)) {\n\t\twindow.setTimeout(onReady);\n\t} else {\n\t\tdocument.addEventListener( \"DOMContentLoaded\", completed );\n\t\twindow.addEventListener( \"load\", completed );\n\t}\n}\n\n/**\n * Function to call when document is ready.  Only run once to perform all waiting websocket messages.\n */\nfunction onReady() {\n\tsetEndpoints();\n\tif (!!window.BSON) {\n\t\tbson = new BSON();\n\t\tif (!!WebSocketServiceInstance) {\n\t\t\tWebSocketServiceInstance\n\t\t\t\t.addSerializer(\"bson\", defaultBsonSerializer)\n\t\t\t\t.addDeserializer(\"bson\", defaultBsonDeserializer);\n\t\t}\n\t}\n\tready = true;\n\tafterReady.forEach(callback=>callback());\n\tafterReady.clear();\n}\n\n/**\n * Check if a status property is not one of a number of enum values.\n *\n * @param {*} status\t\t\tStatus to check.\n * @param {Object} enumeral\t\tEnum to check within.\n * @param {Arrray} checks\t\tEnum values to check.\n * @returns {boolean}\t\t\tDoes it pass the test.\n */\nfunction notEnum(status, enumeral, checks) {\n\tlet _status = true;\n\tchecks.forEach(check=>{\n\t\t_status = _status && (status !== enumeral[check])\n\t});\n\treturn _status;\n}\n\n/**\n * Search through all the locations for websocket endpoint definitions setting these.  Will use defaults if non\n * found. These can be defined in <link rel=\"websocket-endpoint\"> tags, where the title attribute is the endpoint\n * name and the href is the endpoint.\n */\nfunction setEndpoints() {\n\tsetDefaultEndPoint();\n\n\tlet endpointLinkElements = window.document.querySelectorAll(\"link[rel=websocket-endpoint][href]\");\n\tif (endpointLinkElements.length) {\n\t\tfor (let n=0; n < endpointLinkElements.length; n++) {\n\t\t\tlet url = (endpointLinkElements[n].getAttribute(\"href\") || \"\").trim();\n\t\t\tif (url !== \"\") {\n\t\t\t\tlet title = (endpointLinkElements[n].getAttribute(\"title\") || \"\").trim();\n\t\t\t\tif (title === \"\") title = defaultSocketId;\n\t\t\t\tendpoints.set(title, url);\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Set the endpoint of the default endpoint, searching all the definition points for this.\n */\nfunction setDefaultEndPoint() {\n\tconst [origin, baseElement] = [window.location.origin, window.document.querySelector(\"base[href]\")];\n\tlet url;\n\tif (baseElement) {\n\t\tconst base = (baseElement.getAttribute(\"href\") || \"\").trim().replace(origin, \"\");\n\t\tif (base !== \"\") url = `${origin}${base}`;\n\t} else {\n\t\turl = `${origin}/`;\n\t}\n\n\turl = url\n\t\t.replace(\"https://\", \"wss://\")\n\t\t.replace(\"http://\", \"ws://\");\n\n\tendpoints.set(defaultSocketId, url);\n}\n\n/**\n * Create an acknowledge handler.\n *\n * @param {Function} resolve\t\tPromise resolve handler.\n * @param {Function} reject\t\t\tPromise rejection handler.\n * @returns {Function}\t\t\t\tThe handler.\n */\nfunction createAcknowledge(resolve, reject) {\n\treturn (err, response)=>{\n\t\tif (err) return reject(err);\n\t\tif ((response.status || 200) >= 400) {\n\t\t\tif (err) return reject(err);\n\t\t\tconst message = (response.body || response.statusMessage || \"\").trim();\n\t\t\tconst status = (response.status || 400);\n\t\t\treturn reject(new HTTP_ERROR({message, status}));\n\t\t}\n\t\treturn resolve(response);\n\t};\n}\n\n/**\n * Is given websocket ready for transporting data?\n *\n * @param {string} [socketId=defaultSocketId]\t\tThe socket id to test.\n * @returns {boolean}\t\t\t\t\t\t\t\tIs it ready?\n */\nfunction socketReady(socketId=defaultSocketId) {\n\tif (!sockets.has(socketId)) return undefined;\n\tconst ws = sockets.get(socketId);\n\treturn ((ws.readyState === ws.OPEN) ? ws : undefined);\n}\n\n/**\n * Send all the messages for a given socket that are in the queue.\n *\n * @param {string} [socketId=defaultSocketId]\t\tThe socket id to send messages for.\n */\nfunction runSendQueue(socketId=defaultSocketId) {\n\tconst _sendQueue = sendQueue.get(socketId);\n\tconst ws = socketReady(socketId);\n\tif (_sendQueue && ws) {\n\t\t_sendQueue.forEach(messageFunction=>ws.send(messageFunction()));\n\t\t_sendQueue.clear();\n\t\tsendQueue.delete(socketId);\n\t}\n}\n\n/**\n * Send a given message on a given socket.\n *\n * @param {Function} messageFunction\t\t\t\tMessage function to call to generate the message.\n * @param {string} [socketId=defaultSocketId]\t\tThe socket to send on.\n */\nfunction send(messageFunction, socketId=defaultSocketId) {\n\tconst ws = socketReady(socketId);\n\tif (ws) return ws.send(messageFunction());\n\tif (!sendQueue.has(socketId)) sendQueue.set(socketId, new Set());\n\tsendQueue.get(socketId).add(messageFunction);\n}\n\n/**\n * Get callbacksfor given listen type on given socket.\n * @param {string} type\t\t\t\t\t\t\t\tThe type to get for.\n * @param {string} [socketId=defaultSocketId]\t\tThe socket to get callbacks for.\n * @returns {Array.<Function>}\t\t\t\t\t\tArray of callbacks.\n */\nfunction getCallbacks(type, socketId=defaultSocketId) {\n\tif (!callbacks.has(socketId)) callbacks.set(socketId, new Map());\n\tif (!callbacks.get(socketId).has(type)) callbacks.get(socketId).set(type, new Set());\n\treturn callbacks.get(socketId).get(type);\n}\n\n/**\n * Remove the given callback from a callback set.\n *\n * @param {Set.<Set>} callbacks\t\tCallback to search through.\n * @param {Function} callback\t\tCallback to remove.\n */\nfunction removeCallback(callbacks, callback) {\n\tcallbacks.forEach(callbacks=>callbacks.delete(callback));\n}\n\n/**\n * Get the endpoint url for the given socket id.\n *\n * @param {string} [url]\t\t\tThe url to set endpoint to.\n * @param {string} socketId\t\t\tThe socket id to set endpoint on.\n * @returns {string}\t\t\t\tThe endpoint url for given socket id.\n */\nfunction setEnpointUrl(url, socketId) {\n\tif (url) {\n\t\tif (!ready) {\n\t\t\tafterReady.add(()=>endpoints.set(socketId, url));\n\t\t} else {\n\t\t\tendpoints.set(socketId, url);\n\t\t}\n\t}\n\tif (!url && !endpoints.has(socketId)) throw new URIError(`No websocket endpoint for ${socketId}`);\n\tif (!url && endpoints.has(socketId)) url = endpoints.get(socketId);\n\n\treturn url;\n}\n\n/**\n * Try reconnecting to given socket after it has dropped.\n *\n * @param {string} url\t\t\tThe endpoint url for websocket.\n * @param {string} socketId\t\tThe socket id.\n */\nfunction reconnect(url, socketId) {\n\tsockets.delete(socketId);\n\tsetTimeout(()=>{\n\t\tif (notEnum(status.get(socketId), SOCKETSTATUS, ['CONNECTING', 'RECONNECTING', 'CONNECTED'])) {\n\t\t\tstatus.set(socketId, SOCKETSTATUS.RECONNECTING);\n\t\t\tif (!!WebSocketService.DEBUG) console.log(\"Trying reconnect\");\n\t\t\tsockets.set(socketId, new WebSocket(url));\n\t\t\tconnecting(sockets.get(socketId), url, socketId);\n\t\t}\n\t}, 1000*3);\n}\n\nfunction drop(socketId) {\n\tsockets.get(socketId).close();\n}\n\n/**\n * Handle websocket connection, errors and reconnection.\n *\n * @param {WebSocket} ws\t\t\tThe websocket to handle.\n * @param {string} url\t\t\t\tThe endpoint to connect to.\n * @param {string} socketId\t\t\tThe socket id to set.\n */\nfunction connecting(ws, url, socketId) {\n\t/**\n\t * After open listener, setup message handling and send the message queue.\n\t */\n\tfunction open() {\n\t\tstatus.set(socketId, SOCKETSTATUS.CONNECTED);\n\t\tif (!!WebSocketService.DEBUG) console.log(`Opened ${url} for ${socketId}`);\n\t\tws.addEventListener(\"close\", close);\n\t\tws.addEventListener(\"message\", message);\n\t\trunSendQueue(socketId);\n\t}\n\n\t/**\n\t * Close listener, try to reconnect.\n\t */\n\tfunction close() {\n\t\tstatus.set(socketId, SOCKETSTATUS.CLOSED);\n\t\tif (!!WebSocketService.DEBUG) console.log(`Closed ${url} for ${socketId}`);\n\t\tws.removeEventListener(\"open\", open);\n\t\tws.removeEventListener(\"close\", message);\n\t\tws.removeEventListener(\"message\", message);\n\t\treconnect(url, socketId, ws);\n\t}\n\n\t/**\n\t * Handle any websocket errors.\n\t *\n\t * @param {Error} err\t\tError message to handle.\n\t */\n\tfunction error(err) {\n\t\tconsole.error(`Error on ${url} for ${socketId}`, err);\n\t\treturn close();\n\t}\n\n\t/**\n\t * Handle a message event\n\t *\n\t * @param {Event} messageEvent\t\tThe message event to handle.\n\t */\n\tfunction message(messageEvent) {\n\t\tconst respond = message=>{\n\t\t\tif (!message.id) {\n\t\t\t\tif (callbacks.has(message.type)) {\n\t\t\t\t\tcallbacks.get(type).forEach(callbacks=>callback(message.data));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (acknowledgements.has(message.id)) {\n\t\t\t\t\tlet acknowledgement = acknowledgements.get(message.id);\n\t\t\t\t\tif (message.type === 'error') {\n\t\t\t\t\t\tacknowledgement(message.data, null);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tacknowledgement(null, message.data);\n\t\t\t\t\t}\n\t\t\t\t\tacknowledgements.delete(message.id);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tif (typeof messageEvent.data === 'string') {\n\t\t\trespond(deserializers.get('json')(messageEvent.data));\n\t\t} else if (messageEvent.data instanceof Blob) {\n\t\t\tlet reader = new FileReader();\n\t\t\treader.onload = function() {\n\t\t\t\trespond(new buffer.Buffer(new Uint8Array(this.result)));\n\t\t\t};\n\t\t\treader.readAsArrayBuffer(messageEvent.data);\n\t\t}\n\t}\n\n\tws.addEventListener(\"error\", error);\n\tws.addEventListener(\"open\", open);\n}\n\n/**\n * Connect to a given endpoint for socket id supplied.\n *\n * @param {string} [url]\tThe endpoint to connect to.\n * @param socketId\t\t\tThe socket id to connecct for.\n */\nfunction connect(url, socketId) {\n\turl = setEnpointUrl(url, socketId);\n\tif (notEnum(status.get(socketId), SOCKETSTATUS, ['CONNECTING', 'RECONNECTING', 'CONNECTED'])) {\n\t\tstatus.set(socketId, SOCKETSTATUS.CONNECTING);\n\t\tif (!sockets.has(socketId)) sockets.set(socketId, new WebSocket(url));\n\t\tconnecting(sockets.get(socketId), url, socketId);\n\t}\n}\n\n/**\n * Bson serializer.\n *\n * @param {*} data\t\tData to parse into BSON.\n * @returns {Buffer}\tBSON from the data.\n */\nfunction defaultBsonSerializer(data) {\n\ttry {\n\t\treturn bson.serialize(data);\n\t} catch(err) {\n\t\tthrow new TypeError(`Could not convert data to bson for sending`);\n\t}\n}\n\n/**\n * Json serializer (default one applied by default to all new socket channels).\n *\n * @param {*} data\t\tData to parse into JSON.\n * @returns {string}\tJSON from the data.\n */\nfunction defaultJsonSerializer(data) {\n\ttry {\n\t\treturn JSON.stringify(data);\n\t} catch(err) {\n\t\tthrow new TypeError(`Could not convert data to json for sending`);\n\t}\n}\n\n/**\n * Json deserializer (default one applied by default to all new socket channels).\n *\n * @param {string} data\t\t\tData to parse from JSON.\n * @returns {Object|Array|*}\tParsed data.\n */\nfunction defaultJsonDeserializer(data) {\n\ttry {\n\t\treturn JSON.parse(data);\n\t} catch(err) {\n\t\tthrow new TypeError(`Could not convert from json string.`);\n\t}\n}\n\n/**\n * Bson deserializer.\n *\n * @param {string} data\t\t\tData to parse from BSON..\n * @returns {Object|Array|*}\tParsed data.\n */\nfunction defaultBsonDeserializer(data) {\n\ttry {\n\t\treturn bson.deserialize(data);\n\t} catch(err) {\n\t\tthrow new TypeError(`Could not convert from json string.`);\n\t}\n}\n\nlet WebSocketServiceInstance;\n\n/**\n * Websocket handler service\n *\n * @singleton\n */\nclass WebSocketService {\n\tconstructor() {\n\t\tif (!WebSocketServiceInstance) WebSocketServiceInstance = this;\n\t\tthis.addSerializer(\"json\", defaultJsonSerializer).addDeserializer(\"json\", defaultJsonDeserializer);\n\t\tif (!!bson) this.addSerializer(\"bson\", defaultBsonSerializer).addDeserializer(\"bson\", defaultBsonDeserializer);\n\t\treturn WebSocketServiceInstance;\n\t}\n\n\t/**\n\t * Connect to a given endpoint for given socket-id.\n\t *\n\t * @param {string} url\t\t\t\t\t\t\t\tEndpoint to connect to.\n\t * @param {string} [socketId=defaultSocketId]\t\tSocket id to connect for.\n\t */\n\tconnect(url, socketId=defaultSocketId) {\n\t\tif (!url && !ready) return afterReady.add(()=>connect(url, socketId));\n\t\tconnect(url, socketId);\n\t}\n\n\tdrop(socketId=defaultSocketId) {\n\t\tdrop(socketId);\n\t}\n\n\t/**\n\t * Add a listener for given message type on given socket.\n\t *\n\t * @param {Function} callback\t\tListener callback.\n\t * @param {string} type\t\t\t\tMessage type to listen for.\n\t * @param {string} socketId\t\t\tSocket id to use.\n\t * @returns {Function}\t\t\t\tUnlisten function.\n\t */\n\tlisten(callback, type, socketId=defaultSocketId) {\n\t\tgetCallbacks(type, socketId).add(callback);\n\t\treturn ()=>getCallbacks(type, socketId).delete(callback);\n\t}\n\n\t/**\n\t * Remove a given listener on the given socket.\n\t *\n\t * @param {Function} callback\t\tListener to remove.\n\t * @param {string} socketId\t\t\tSocket id to remove listener on.\n\t */\n\tremoveListener(callback, socketId) {\n\t\tif (socketId && callbacks.has(socketId)) return removeCallback(callbacks.get(socketId), callback);\n\t\tcallbacks.forEach(callbacks=>removeCallback(callbacks, callback));\n\t}\n\n\t/**\n\t * Send a request on the given socket.\n\t *\n\t * @param {Object} data\t\t\t\t\t\t\tData to send.\n\t * @param {string} [socketId=defaultSocketId]\tSocket to send on.\n\t * @param {string} [type=json]\t\t\t\t\tType of data to send.\n\t * @returns {Promise.<Object>}\t\t\t\t\tPromise resolving to server response.\n\t */\n\trequest(data, socketId=defaultSocketId, type='json') {\n\t\tdata.method = data.method || \"get\";\n\n\t\treturn new Promise((resolve, reject)=>{\n\t\t\tconst id = randomString();\n\t\t\tacknowledgements.set(id, createAcknowledge(resolve, reject));\n\t\t\tconst message = {type:\"request\", id, data};\n\n\t\t\tsend(()=>{\n\t\t\t\tif (serializers.has(type)) return serializers.get(type)(message);\n\t\t\t\tthrow new TypeError(`No parser for type ${type}`);\n\t\t\t}, socketId);\n\t\t});\n\t}\n\n\trequestJson(data, socketId=defaultSocketId) {\n\t\treturn this.request(data, socketId, 'json');\n\t}\n\n\trequestBson(data, socketId=defaultSocketId) {\n\t\treturn this.request(data, socketId, 'bson');\n\t}\n\n\t/**\n\t * Is given socket open and ready?\n\t *\n\t * @param {string} [socketId=defaultSocketId]\t\tSocket to test for readiness.\n\t * @returns {boolean}\t\t\t\t\t\t\t\tIs it ready?\n\t */\n\tready(socketId=defaultSocketId) {\n\t\treturn !!socketReady(socketId);\n\t}\n\n\t/**\n\t * Add an endpoint url for a given id.\n\t *\n\t * @param {string} id\t\t\t\tThe id set endpoint on.\n\t * @param {string} url\t\t\t\tThe endpoint url.\n\t * @param {WebSocketService}\t\tFor chaining.\n\t */\n\taddEndpoint(id, url) {\n\t\tendpoints.set(id, url);\n\t\treturn this;\n\t}\n\n\t/**\n\t * remove an endpoint for a given id.\n\t *\n\t * @param {string} id\t\t\t\tThe id to remove an endpoint for.\n\t * @param {WebSocketService}\t\tFor chaining.\n\t */\n\tremoveEndpoint(id) {\n\t\tendpoints.delete(id);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Add a message serializer for given type.\n\t *\n\t * @param {string} type\t\t\t\tMessage type to add for.\n\t * @param {Function} serializer\t\tSerializer function to add.\n\t * @returns {WebSocketService}\t\tFor chaining.\n\t */\n\taddSerializer(type, serializer) {\n\t\tserializers.set(type, serializer);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Remove a serializer for a given message type.\n\t *\n\t * @param {string} type\t\t\t\tMessage type to remove for.\n\t * @returns {WebSocketService}\t\tFor chaining.\n\t */\n\tremoveSerializer(type) {\n\t\tserializers.delete(type);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Add a message deserializer for given type.\n\t *\n\t * @param {string} type\t\t\t\t\tMessage type to add for.\n\t * @param {Function} deserializer\t\tDeserializer function to add.\n\t * @returns {WebSocketService}\t\t\tFor chaining.\n\t */\n\taddDeserializer(type, deserializer) {\n\t\tdeserializers.set(type, deserializer);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Remove a deserializer for a given message type.\n\t *\n\t * @param {string} type\t\t\t\tMessage type to remove for.\n\t * @returns {WebSocketService}\t\tFor chaining.\n\t */\n\tremoveDeserializer(type) {\n\t\tdeserializers.delete(type);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Get the default socket id.\n\t *\n\t * @returns {string}\n\t */\n\tget defaultSocketId() {\n\t\treturn defaultSocketId;\n\t}\n\n\t/**\n\t * Get the object type string.\n\t *\n\t * @returns {string}\n\t */\n\tget [Symbol.toStringTag]() {\n\t\treturn \"WebSocketService\";\n\t}\n}\n\nWebSocketService.DEBUG = false;\n\ninit();\n"],"names":["Symbol","objectProto","nativeObjectToString","symToStringTag","hasOwnProperty","funcProto","funcToString","Map","Set","chars","split","randomInt","end","start","Math","floor","random","randomString","length","Array","fill","map","join","buffer","window","ready","bson","afterReady","defaultSocketId","endpoints","callbacks","acknowledgements","sendQueue","sockets","serializers","deserializers","status","SOCKETSTATUS","Object","freeze","CONNECTING","RECONNECTING","CLOSED","CONNECTED","HTTP_ERROR","message","params","Error","init","jQuery","$","undefined","angular","bolt","doc","document","websocket","WebSocketService","module","factory","MODE","has","DEBUG","completed","removeEventListener","onReady","readyState","documentElement","doScroll","setTimeout","addEventListener","setEndpoints","BSON","WebSocketServiceInstance","addSerializer","defaultBsonSerializer","addDeserializer","defaultBsonDeserializer","forEach","callback","clear","notEnum","enumeral","checks","_status","check","setDefaultEndPoint","endpointLinkElements","querySelectorAll","n","url","getAttribute","trim","title","set","location","origin","querySelector","baseElement","base","replace","createAcknowledge","resolve","reject","err","response","body","statusMessage","socketReady","socketId","ws","get","OPEN","runSendQueue","_sendQueue","send","messageFunction","delete","add","getCallbacks","type","removeCallback","setEnpointUrl","URIError","reconnect","console","log","WebSocket","connecting","drop","close","open","error","messageEvent","respond","id","data","acknowledgement","Blob","reader","FileReader","onload","Buffer","Uint8Array","result","readAsArrayBuffer","connect","serialize","TypeError","defaultJsonSerializer","JSON","stringify","defaultJsonDeserializer","parse","deserialize","method","Promise","request","serializer","deserializer","toStringTag"],"mappings":"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CA;EACA;EACA;EACA;EACA;EACA,GAAG;;ECTH;EACA;EACA;EACA;EACA;EACA;EACA,GAAG;;ECNH;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,GAAG;;EC5BH;EACA,IAAIG,KAAG,GAAG,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;;ECJjC;EACA;EACA;EACA;EACA;EACA;EACA,GAAG;;ECNH,oDAAoD;;ECApD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,GAAG;;ECRH;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,GAAG;;ECVH;EACA;EACA;EACA;EACA;EACA;EACA,GAAG;;ECNH;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,GAAG;;ECTH;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,GAAG;;ECRH;EACA;EACA;EACA;EACA;EACA;EACA;EACA,GAAG;;ECJH;EACA,IAAIC,KAAG,GAAG,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;;ECJjC;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,SAAS,IAAI,GAAG;EAChB;EACA,CAAC;;ECdD;EACA;EACA;EACA;EACA;EACA;EACA;EACA,SAAS,UAAU,CAAC,GAAG,EAAE;EACzB,EAAE,IAAI,KAAK,GAAG,CAAC,CAAC;EAChB,MAAM,MAAM,GAAG,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;;EAE/B,EAAE,GAAG,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE;EAC9B,IAAI,MAAM,CAAC,EAAE,KAAK,CAAC,GAAG,KAAK,CAAC;EAC5B,GAAG,CAAC,CAAC;EACL,EAAE,OAAO,MAAM,CAAC;EAChB,CAAC;;ECXD;EACA,IAAI,QAAQ,GAAG,CAAC,GAAG,CAAC,CAAC;;EAErB;EACA;EACA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"}