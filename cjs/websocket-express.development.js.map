{"version":3,"file":"websocket-express.development.js","sources":["src/expressWebsocket.js","node_modules/lodash-es/_arrayPush.js","node_modules/lodash-es/_freeGlobal.js","node_modules/lodash-es/_root.js","node_modules/lodash-es/_Symbol.js","node_modules/lodash-es/_getRawTag.js","node_modules/lodash-es/_objectToString.js","node_modules/lodash-es/_baseGetTag.js","node_modules/lodash-es/isObjectLike.js","node_modules/lodash-es/_baseIsArguments.js","node_modules/lodash-es/isArguments.js","node_modules/lodash-es/isArray.js","node_modules/lodash-es/_isFlattenable.js","node_modules/lodash-es/_baseFlatten.js","node_modules/lodash-es/flatten.js","node_modules/lodash-es/isObject.js","node_modules/lodash-es/isFunction.js","node_modules/lodash-es/_coreJsData.js","node_modules/lodash-es/_isMasked.js","node_modules/lodash-es/_toSource.js","node_modules/lodash-es/_baseIsNative.js","node_modules/lodash-es/_getValue.js","node_modules/lodash-es/_getNative.js","node_modules/lodash-es/_nativeCreate.js","node_modules/lodash-es/_hashClear.js","node_modules/lodash-es/_hashDelete.js","node_modules/lodash-es/_hashGet.js","node_modules/lodash-es/_hashHas.js","node_modules/lodash-es/_hashSet.js","node_modules/lodash-es/_Hash.js","node_modules/lodash-es/_listCacheClear.js","node_modules/lodash-es/eq.js","node_modules/lodash-es/_assocIndexOf.js","node_modules/lodash-es/_listCacheDelete.js","node_modules/lodash-es/_listCacheGet.js","node_modules/lodash-es/_listCacheHas.js","node_modules/lodash-es/_listCacheSet.js","node_modules/lodash-es/_ListCache.js","node_modules/lodash-es/_Map.js","node_modules/lodash-es/_mapCacheClear.js","node_modules/lodash-es/_isKeyable.js","node_modules/lodash-es/_getMapData.js","node_modules/lodash-es/_mapCacheDelete.js","node_modules/lodash-es/_mapCacheGet.js","node_modules/lodash-es/_mapCacheHas.js","node_modules/lodash-es/_mapCacheSet.js","node_modules/lodash-es/_MapCache.js","node_modules/lodash-es/_setCacheAdd.js","node_modules/lodash-es/_setCacheHas.js","node_modules/lodash-es/_SetCache.js","node_modules/lodash-es/_baseFindIndex.js","node_modules/lodash-es/_baseIsNaN.js","node_modules/lodash-es/_strictIndexOf.js","node_modules/lodash-es/_baseIndexOf.js","node_modules/lodash-es/_arrayIncludes.js","node_modules/lodash-es/_arrayIncludesWith.js","node_modules/lodash-es/_cacheHas.js","node_modules/lodash-es/_Set.js","node_modules/lodash-es/noop.js","node_modules/lodash-es/_setToArray.js","node_modules/lodash-es/_createSet.js","node_modules/lodash-es/_baseUniq.js","node_modules/lodash-es/uniq.js","node_modules/lodash-es/isString.js","src/util.js","src/requestHeaders.js","src/request.js","src/response.js","src/server.js"],"sourcesContent":["import http from 'http';\nimport ws from 'ws';\n\nexport function handleUpgrade(app, wss=new ws.Server({noServer:true})) {\n  // https://github.com/websockets/ws/blob/master/lib/WebSocketServer.js#L77\n  return function (req, socket, upgradeHead) {\n    const res = new http.ServerResponse(req);\n    res.assignSocket(socket);\n\n    // avoid hanging onto upgradeHead as this will keep the entire\n    // slab buffer used by node alive\n    const head = new Buffer(upgradeHead.length);\n    upgradeHead.copy(head);\n\n    res.on('finish', ()=>res.socket.destroy());\n\n    res.websocket = cb=>wss.handleUpgrade(req, socket, head, client=>{\n      wss.emit('connection', client);\n      if (cb) cb(client, app);\n    });\n\n    return app(req, res);\n  };\n};\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nexport default arrayPush;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nexport default baseIsArguments;\n","import baseIsArguments from './_baseIsArguments.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nexport default isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nexport default isArray;\n","import Symbol from './_Symbol.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\n\n/** Built-in value references. */\nvar spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\nexport default isFlattenable;\n","import arrayPush from './_arrayPush.js';\nimport isFlattenable from './_isFlattenable.js';\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\nexport default baseFlatten;\n","import baseFlatten from './_baseFlatten.js';\n\n/**\n * Flattens `array` a single level deep.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to flatten.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * _.flatten([1, [2, [3, [4]], 5]]);\n * // => [1, 2, [3, [4]], 5]\n */\nfunction flatten(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? baseFlatten(array, 1) : [];\n}\n\nexport default flatten;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n","import baseGetTag from './_baseGetTag.js';\nimport isObject from './isObject.js';\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nexport default isFunction;\n","import root from './_root.js';\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nexport default coreJsData;\n","import coreJsData from './_coreJsData.js';\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nexport default isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nexport default toSource;\n","import isFunction from './isFunction.js';\nimport isMasked from './_isMasked.js';\nimport isObject from './isObject.js';\nimport toSource from './_toSource.js';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nexport default baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nexport default getValue;\n","import baseIsNative from './_baseIsNative.js';\nimport getValue from './_getValue.js';\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nexport default getNative;\n","import getNative from './_getNative.js';\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nexport default nativeCreate;\n","import nativeCreate from './_nativeCreate.js';\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nexport default hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default hashDelete;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nexport default hashGet;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nexport default hashHas;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nexport default hashSet;\n","import hashClear from './_hashClear.js';\nimport hashDelete from './_hashDelete.js';\nimport hashGet from './_hashGet.js';\nimport hashHas from './_hashHas.js';\nimport hashSet from './_hashSet.js';\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nexport default Hash;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nexport default listCacheClear;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nexport default eq;\n","import eq from './eq.js';\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nexport default assocIndexOf;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nexport default listCacheDelete;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nexport default listCacheGet;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nexport default listCacheHas;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nexport default listCacheSet;\n","import listCacheClear from './_listCacheClear.js';\nimport listCacheDelete from './_listCacheDelete.js';\nimport listCacheGet from './_listCacheGet.js';\nimport listCacheHas from './_listCacheHas.js';\nimport listCacheSet from './_listCacheSet.js';\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nexport default ListCache;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nexport default Map;\n","import Hash from './_Hash.js';\nimport ListCache from './_ListCache.js';\nimport Map from './_Map.js';\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nexport default mapCacheClear;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nexport default isKeyable;\n","import isKeyable from './_isKeyable.js';\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nexport default getMapData;\n","import getMapData from './_getMapData.js';\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default mapCacheDelete;\n","import getMapData from './_getMapData.js';\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nexport default mapCacheGet;\n","import getMapData from './_getMapData.js';\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nexport default mapCacheHas;\n","import getMapData from './_getMapData.js';\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nexport default mapCacheSet;\n","import mapCacheClear from './_mapCacheClear.js';\nimport mapCacheDelete from './_mapCacheDelete.js';\nimport mapCacheGet from './_mapCacheGet.js';\nimport mapCacheHas from './_mapCacheHas.js';\nimport mapCacheSet from './_mapCacheSet.js';\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nexport default MapCache;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nexport default setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nexport default setCacheHas;\n","import MapCache from './_MapCache.js';\nimport setCacheAdd from './_setCacheAdd.js';\nimport setCacheHas from './_setCacheHas.js';\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nexport default SetCache;\n","/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default baseFindIndex;\n","/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nexport default baseIsNaN;\n","/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default strictIndexOf;\n","import baseFindIndex from './_baseFindIndex.js';\nimport baseIsNaN from './_baseIsNaN.js';\nimport strictIndexOf from './_strictIndexOf.js';\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? strictIndexOf(array, value, fromIndex)\n    : baseFindIndex(array, baseIsNaN, fromIndex);\n}\n\nexport default baseIndexOf;\n","import baseIndexOf from './_baseIndexOf.js';\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\nexport default arrayIncludes;\n","/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arrayIncludesWith;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nexport default cacheHas;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nexport default Set;\n","/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nexport default noop;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nexport default setToArray;\n","import Set from './_Set.js';\nimport noop from './noop.js';\nimport setToArray from './_setToArray.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n  return new Set(values);\n};\n\nexport default createSet;\n","import SetCache from './_SetCache.js';\nimport arrayIncludes from './_arrayIncludes.js';\nimport arrayIncludesWith from './_arrayIncludesWith.js';\nimport cacheHas from './_cacheHas.js';\nimport createSet from './_createSet.js';\nimport setToArray from './_setToArray.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : createSet(array);\n    if (set) {\n      return setToArray(set);\n    }\n    isCommon = false;\n    includes = cacheHas;\n    seen = new SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nexport default baseUniq;\n","import baseUniq from './_baseUniq.js';\n\n/**\n * Creates a duplicate-free version of an array, using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons, in which only the first occurrence of each element\n * is kept. The order of result values is determined by the order they occur\n * in the array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniq([2, 1, 2]);\n * // => [2, 1]\n */\nfunction uniq(array) {\n  return (array && array.length) ? baseUniq(array) : [];\n}\n\nexport default uniq;\n","import baseGetTag from './_baseGetTag.js';\nimport isArray from './isArray.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar stringTag = '[object String]';\n\n/**\n * Checks if `value` is classified as a `String` primitive or object.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a string, else `false`.\n * @example\n *\n * _.isString('abc');\n * // => true\n *\n * _.isString(1);\n * // => false\n */\nfunction isString(value) {\n  return typeof value == 'string' ||\n    (!isArray(value) && isObjectLike(value) && baseGetTag(value) == stringTag);\n}\n\nexport default isString;\n","import {isObject, isString, isNumber, isBoolean, uniq as unique, flatten} from 'lodash-es';\n\nconst chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz'.split('');\n\n\n/**\n * Generate a random integer between a start end end value.\n *\n * @param {integer} end\t\t\t\tThe start of the range.\n * @param {integer} [start=0]\t\tThe end of the range.\n * @returns {integer}\t\t\t\tRandom generated number.\n */\nexport function randomInt(end, start=0) {\n\treturn Math.floor(Math.random() * end) + start;\n}\n\n/**\n * Generate a randomstring.\n *\n * @param {integer} [length=32]\t\tThe length of string to generate.\n * @returns {string}\t\t\t\tRandom generated string.\n */\nexport function randomString(length=32) {\n\treturn (new Array(length)).fill(0).map(()=>chars[randomInt(chars.length - 1)]).join('');\n}\n\n/**\n * Get the length of a message object. Used to fake the content-length header in socket.io routes.\n *\n * @private\n * @param {*} message     Message to get length of.  This is assumed to be an object.\n * @returns {number}      Message length.\n */\nexport function getContentLength(message) {\n\ttry {\n\t\tif (isObject(message)) return JSON.stringify(message || {}).length.toString();\n\t\treturn message.toString().length.toString();\n\t} catch(err) {}\n\n\treturn \"1\";\n}\n\n/**\n * Define a defineProperty object for non-configurable property.\n *\n * @param {Object} instance\t\t\t\t\t\t\tInstance to do defineProperty on.\n * @param {string|Array.<string>} propertyName\t\tProperty name(s) to do defineProperty on.\n * @param {*} value\t\t\t\t\t\t\t\t\tThe property value to set.\n * @returns {Object}\t\t\t\t\t\t\t\tThe the instance for chaining purposes.\n */\nexport function definePropertyFixed(instance, propertyName, value) {\n\tmakeArray(propertyName).forEach((_propertyName, n)=>Object.defineProperty(instance, _propertyName, {\n\t\tconfigurable: false,\n\t\tenumerable: true,\n\t\tget: ()=>Array.isArray(propertyName)?value[n]:value,\n\t\tset: ()=>false\n\t}));\n\n\treturn instance;\n}\n\n/**\n * Define a defineProperty object for a standard enumerable, read/write property.\n *\n * @param {Object} instance\t\t\t\t\t\t\tInstance to do defineProperty on.\n * @param {string|Array.<string>} propertyName\t\tProperty name(s) to do defineProperty on.\n * @param {*} value\t\t\t\t\t\t\t\t\tThe property value to set.\n * @param {boolean} [configurable=false]\t\t\tIs this going to set the configurable property?\n * @returns {Object}\t\t\t\t\t\t\t\tThe the instance for chaining purposes.\n */\nexport function defineProperty(instance, propertyName, value, configurable=false) {\n\tmakeArray(propertyName).forEach((_propertyName, n)=>Object.defineProperty(instance, _propertyName, {\n\t\tconfigurable,\n\t\tenumerable: true,\n\t\twritable: true,\n\t\tvalue:Array.isArray(propertyName)?value[n]:value\n\t}));\n\n\treturn instance;\n}\n\n/**\n * Bind a given set of methods in one object to another object.\n *\n * @param {Object} takeFrom\t\t\tObject to bind methods in.\n * @param {Object} bindTo\t\t\tObject to bind each method to.\n * @param {Array} methods\t\t\tMethods to bind.\n * @returns {Object}\t\t\t\tThe takeFrom object for chaining.\n */\nexport function rebinder(takeFrom, bindTo, methods) {\n\tmakeArray(methods.methods).forEach(method=>{\n\t\tbindTo[method] = takeFrom[method].bind(bindTo);\n\t});\n\tmakeArray(methods.properties).forEach(property=>Object.defineProperty(bindTo, property, {\n\t\tget: ()=>takeFrom[property],\n\t\tset: value=>{takeFrom[property] = value}\n\t}));\n\n\treturn takeFrom;\n}\n\n/**\n * Turn the given value into an array.  If it is already an array then return it; if it is a set then convert to an\n * array; and if neither then return as the first item in an array. The purpose of this function is for function\n * or method parameters where they can be either a array or not.  You can use this to ensure you are working on\n * an array.\n *\n * @public\n * @param {Array|Set|*} value\t\tValue to return or convert.\n * @returns {Array}\t\t\t\t\tThe converted value (or original if already an array).\n */\nexport function makeArray(value) {\n\tif (value === undefined) return [];\n\tif (value instanceof Set) return [...value];\n\treturn (Array.isArray(value) ? value : [value]);\n}\n\nexport {isObject};\nexport {isString};\nexport {isNumber};\nexport {isBoolean};\nexport {unique};\nexport {flatten};","import {unique, flatten} from './util';\n\nconst ignoreHeaders = ['upgrade', 'sec-websocket-key', 'sec-websocket-version', 'sec-websocket-extensions'];\nconst addHeaders = {\n\tConnection: 'keep-alive'\n};\n\n/**\n * Should a given request header be excluded in the new generated request? Used to remove upgrade style headers from\n * the generated request.\n *\n * @param {string} header\t\tHeader name to test.\n * @returns {boolean}\t\t\tShould it be excluded.\n */\nfunction excludeHeader(header) {\n\treturn (Object.keys(addHeaders).includes(header.toString()) || ignoreHeaders.includes(header.toString().toLowerCase()));\n}\n\n/**\n * Given a request object and a message object, return a rawHeaders property for the request.\n *\n * @param {WebsocketRequest} req\t\tThe request to get rawHeaders on.\n * @param {Object} message\t\t\t\tThe associated websocket message.\n * @returns {Array.<string>}\t\t\tThe rawHeaders array.\n */\nexport function rawHeadersFactory(req, message) {\n\tlet filterNext = false;\n\n\treturn flatten(...Object.keys(addHeaders).map(headerName=>[headerName, addHeaders[headerName]])).concat(\n\t\treq.rawHeaders.map(header=>{\n\t\t\tif (!filterNext && !excludeHeader(header)) return header;\n\t\t\tfilterNext = !filterNext;\n\t\t}).filter(\n\t\t\theader=>header\n\t\t)\n\t).concat(\n\t\tflatten(...Object.keys(message.headers).map(headerName=>[headerName, message.headers[headerName]])).map(header=>{\n\t\t\tif (!filterNext && !excludeHeader(header)) return header;\n\t\t\tfilterNext = !filterNext;\n\t\t}).filter(\n\t\t\theader=>header\n\t\t)\n\t);\n}\n\n/**\n * Factory for generating headers for WebsocketRequest.\n *\n * @param {WebsocketRequest} req\t\tThe request to generate headers on.\n * @param {Object} message\t\t\t\tThe associated websocket message.\n * @returns {Proxy}\t\t\t\t\t\tHeaders object.\n */\nexport function requestHeadersFactory(req, message) {\n\tlet headers = {};\n\n\tObject.keys(req.headers).forEach(_header=>{\n\t\tlet header = _header.toLocaleLowerCase();\n\t\tif (!ignoreHeaders.includes(header)) headers[header] = req.headers[_header];\n\t});\n\tObject.keys(message.headers || {}).forEach(key=>{\n\t\theaders[key.toLocaleLowerCase()] = message.headers[key];\n\t});\n\tObject.keys(addHeaders).forEach(key=>{\n\t\theaders[key.toLocaleLowerCase()] = addHeaders[key];\n\t});\n\n\treturn new Proxy(headers, {\n\t\tget: (target, property, receiver)=>{\n\t\t\treturn Reflect.get(target, property, receiver) ||\n\t\t\t\t((!ignoreHeaders.includes(property)) ? Reflect.get(req.headers, property, receiver) : undefined);\n\t\t},\n\n\t\tset: (target, property, value, receiver)=>{\n\t\t\treturn Reflect.set(target, property, value, receiver);\n\t\t},\n\n\t\thas: (target, property)=>{\n\t\t\treturn Reflect.has(target, property) ||\n\t\t\t\t((!ignoreHeaders.includes(property)) ? Reflect.has(req.headers, property) : undefined);\n\t\t},\n\n\t\tgetOwnPropertyDescriptor(target, property) {\n\t\t\tif (Reflect.has(target, property)) return Reflect.getOwnPropertyDescriptor(target, property);\n\t\t\tif (!ignoreHeaders.includes(property) && Reflect.has(req.headers, property)) {\n\t\t\t\treturn Reflect.getOwnPropertyDescriptor(req.headers, property);\n\t\t\t}\n\t\t},\n\n\t\townKeys(target) {\n\t\t\tlet reqHeaders = Reflect.ownKeys(req.headers).filter(header=>!ignoreHeaders.includes(header));\n\t\t\treturn unique(Reflect.ownKeys(target).concat(reqHeaders));\n\t\t}\n\t});\n}","import {requestHeadersFactory, rawHeadersFactory} from './requestHeaders';\nimport typeis from 'type-is';\nimport {isObject, defineProperty, definePropertyFixed, rebinder} from './util';\nimport EventEmitter from 'events';\n\nconst originalRequests = new WeakMap();\nconst originalMessages = new WeakMap();\n\n\nconst rebind = {\n\tmethods: ['accepts', 'acceptsCharsets', 'acceptsEncodings', 'acceptsLanguages', 'param'],\n\tproperties: ['hostname', 'ip', 'ips', 'subdomains', 'cookies', 'signedCookies', 'sessionID', 'session']\n};\n\n\n/**\n * Get the request body from a message object.\n *\n * @param {Object} message\t\t\tMessage object to get from.\n * @returns {Object}\t\t\t\tThe message body object.\n */\nfunction getBody(message) {\n\treturn isObject(message.body) ? Object.assign({}, message.body) : (message.body || {});\n}\n\n/**\n * Object to mixin to the Request object.\n *\n * @type {Object}\n */\nconst WebsocketRequestAbstract = {\n\t/**\n\t * Get a header value.\n\t *\n\t * @param {string} header\t\tThe header to get.\n\t * @returns {*}\t\t\t\t\tThe header value.\n\t */\n\tget: function(header) {\n\t\treturn this.headers[header];\n\t},\n\n\t/**\n\t * Is the message of a given mime-type?\n\t *\n\t * @param {string|Array.<string>}\t\tMimetype(s) to match.\n\t * @returns {boolean}\t\t\t\t\tDoes the request match one of the given mimetypes?\n\t */\n\tis: function (...types) {\n\t\treturn typeis(this, types);\n\t}\n};\n\nexport class WebsocketRequest extends EventEmitter {\n\tconstructor(req, message, messageId, wsId) {\n\t\tsuper();\n\n\t\tdefineProperty(this, 'body', getBody(message), true);\n\t\tdefineProperty(\n\t\t\tthis,\n\t\t\t['method', 'originalUrl', 'params', 'path', 'query', 'url'],\n\t\t\t[message.method, message.path, {}, message.path, {}, message.path]\n\t\t);\n\n\t\tdefinePropertyFixed(\n\t\t\tthis,\n\t\t\t['app', 'headers', 'messageId', 'protocol', 'rawHeaders', 'secure', 'websocket', 'xhr', '_req', 'websocketId'],\n\t\t\t[\n\t\t\t\treq.app,\n\t\t\t\trequestHeadersFactory(req, message),\n\t\t\t\tmessageId,\n\t\t\t\t(req.secure ? 'wss' : 'ws'),\n\t\t\t\trawHeadersFactory(req, message),\n\t\t\t\treq.secure,\n\t\t\t\ttrue,\n\t\t\t\tfalse,\n\t\t\t\treq,\n\t\t\t\twsId\n\t\t\t]\n\t\t);\n\n\t\trebinder(WebsocketRequestAbstract, this, {methods: Object.keys(WebsocketRequestAbstract)});\n\t\trebinder(req, this, rebind);\n\n\t\toriginalRequests.set(this, req);\n\t\toriginalMessages.set(this, message);\n\t}\n}","import {isObject, defineProperty, rebinder, definePropertyFixed} from './util';\nimport mime from 'mime';\nimport vary from 'vary';\nimport depd from 'depd';\nimport contentDisposition from 'content-disposition';\nimport statuses from 'statuses';\n\nconst deprecate = depd('express');\nconst clients = new WeakMap();\nconst messageIdIds = new WeakMap();\nconst messageRecieveType = new WeakMap();\n\n\n/**\n * Create a new message as a response from given WebsocketResponse and body object.\n *\n * @param {WebsocketResponse} res\t\tResponse instance.\n * @param {Object|*} body\t\t\t\tBody object.\n * @returns {Object}\t\t\t\t\tNew response message.\n */\nfunction createResponseMessage(res, body) {\n\treturn {\n\t\tid: messageIdIds.get(res),\n\t\ttype: 'response',\n\t\tdata: {\n\t\t\tpath: res.req.originalUrl,\n\t\t\tbody,\n\t\t\theaders: res.headers || {},\n\t\t\tstatus: res.statusCode,\n\t\t\tstatusMessage: res.statusMessage || '',\n\t\t\ttype: res.get('Content-Type') || 'application/json'\n\t\t}\n\t};\n}\n\n/**\n * Send a message, using the given response instance and message.\n *\n * @param {WebsocketResponse} res\t\tThe request object.\n * @param {Object} message\t\t\t\tThe message object.\n * @param {WebsocketResponse}\t\t\tFor chaining.\n */\nfunction sendMessage(res, message) {\n\tconst type = messageRecieveType.get(res);\n\tconst client = clients.get(res);\n\tif (client) client.send(JSON.stringify(message));\n\tres.headersSent = true;\n\treturn res;\n}\n/**\n * Mixin for WebsocketResponse instances.\n *\n * @type {Object}\n */\nconst WebsocketResponseAbstract = {\n\t/**\n\t * Append additional header `field` with value `val`.\n\t *\n\t * Example:\n\t *\n\t *    res.append('Link', ['<http://localhost/>', '<http://localhost:3000/>']);\n\t *    res.append('Set-Cookie', 'foo=bar; Path=/; HttpOnly');\n\t *    res.append('Warning', '199 Miscellaneous warning');\n\t *\n\t * @public\n\t * @param {String} field\t\t\tField to set.\n\t * @param {String|Array} val\t\tValue to set.\n\t * @return {WebsocketResponse} \t\tFor chaining.\n\t */\n\tappend: function(field, val) {\n\t\tlet prev = this.get(field);\n\t\tlet value = val;\n\n\t\tif (prev) value = (Array.isArray(prev) ?\n\t\t\t\tprev.concat(val) :\n\t\t\t\t(Array.isArray(val) ? [prev].concat(val) : [prev, val])\n\t\t);\n\n\t\treturn this.set(field, value);\n\t},\n\n\t/**\n\t * Set _Content-Disposition_ header to _attachment_ with optional `filename`.\n\t *\n\t * @public\n\t * @param {String} filename\t\t\tFilename to set it to.\n\t * @return {WebsocketResponse}\t\tFor chaining.\n\t */\n\tattachment: function(filename) {\n\t\tif (filename) this.type(extname(filename));\n\t\tthis.set('Content-Disposition', contentDisposition(filename));\n\t\treturn this;\n\t},\n\n\tcookie: function(name, value, options) {\n\n\t},\n\n\tclearCookie: function(name, options) {\n\n\t},\n\n\tdownload: function(path, filename, fn) {\n\n\t},\n\n\tend: function(data, encoding) {\n\n\t},\n\n\tformat: function(object) {\n\n\t},\n\n\t/**\n\t * Get a specific header value.\n\t *\n\t * @param {string} field\t\tThe header to het.\n\t * @returns {*}\t\t\t\t\tThe header value.\n\t */\n\tget: function(field) {\n\t\treturn this.headers[field];\n\t},\n\n\t/**\n\t * Get a specific header value.\n\t *\n\t * @param {string} field\t\tThe header to het.\n\t * @returns {*}\t\t\t\t\tThe header value.\n\t */\n\tgetHeader: function(field) {\n\t\treturn this.get(field);\n\t},\n\n\t/**\n\t * Get all the header names.\n\t *\n\t * @returns {Array.<string>}\t\tArray of header names.\n\t */\n\tgetHeaderNames: function() {\n\t\treturn Object.keys(this.headers).sort();\n\t},\n\n\t/**\n\t * Get all the headers.\n\t *\n\t * @returns {Object}\t\tThe headers object.\n\t */\n\tgetHeaders: function() {\n\t\treturn this.headers;\n\t},\n\n\t/**\n\t * Test if response has a particular header.\n\t *\n\t * @param {string} header\t\tHeader to test.\n\t * @returns {boolean}\t\t\tDoes it have given header?\n\t */\n\thasHeader: function(header) {\n\t\treturn (header in this.headers);\n\t},\n\n\t/**\n\t * Send JSON response.\n\t *\n\t * Examples:\n\t *\n\t *     res.json(null);\n\t *     res.json({ user: 'tj' });\n\t *\n\t * @public\n\t * @param {string|number|boolean|object} body\t\tBody to send.\n\t * @return {WebsocketResponse} \t\t\t\t\t\tFor chaining.\n\t */\n\tjson: function(body) {\n\t\tthis.type('application/json');\n\t\treturn this.send(body);\n\t},\n\n\t/**\n\t * Send JSON response with JSONP callback support.\n\t *\n\t * Examples:\n\t *\n\t *     res.jsonp(null);\n\t *     res.jsonp({ user: 'tj' });\n\t *\n\t * @public\n\t * @param {string|number|boolean|object} body\t\tBody to send.\n\t * @return {WebsocketResponse} \t\t\t\t\t\tFor chaining\n\t */\n\tjsonp: function(body) {\n\t\tthis.type('application/javascript');\n\t\tlet response = createResponseMessage(this, body);\n\t\tresponse.data.callback = this.app.get('jsonp callback name') || 'callback';\n\t\treturn this.send(body);\n\t},\n\n\tlinks: function(links) {\n\n\t},\n\n\t/**\n\t * Set the location header to `url`.\n\t *\n\t * The given `url` can also be \"back\", which redirects to the _Referrer_ or _Referer_ headers or \"/\".\n\t *\n\t * Examples:\n\t *\n\t *    res.location('/foo/bar').;\n\t *    res.location('http://example.com');\n\t *    res.location('../login');\n\t *\n\t * @public\n\t * @param {String} url\t\t\t\tUrl to set location to.\n\t * @return {WebsocketResponse} \t\tFor chaining\n\t */\n\tlocation: function(path) {\n\t\tthis.set('location', path);\n\t},\n\n\t/**\n\t * Redirect to the given `url` with optional response `status` defaulting to 302.\n\t *\n\t * The resulting `url` is determined by `res.location()`, so it will play nicely with mounted apps, relative paths,\n\t * `\"back\"` etc.\n\t *\n\t * Examples:\n\t *\n\t *    res.redirect('/foo/bar');\n\t *    res.redirect('http://example.com');\n\t *    res.redirect(301, 'http://example.com');\n\t *    res.redirect('../login'); // /blog/post/1 -> /blog/login\n\t *\n\t * @public\n\t * @param {number} [status=302]\t\tStatus to send.\n\t * @param {string} path\t\t\t\tPath to redirect to.\n\t * @return {WebsocketResponse} \t\tFor chaining.\n\t */\n\tredirect: function(status, path) {\n\t\tif (!path) [status, path] = [302, status];\n\t\tthis.status(status);\n\t\tthis.type('plain/text');\n\t\tthis.send(path);\n\t},\n\n\trender: function(view, locals, callback) {\n\n\t},\n\n\t/**\n\t * Send a response.\n\t *\n\t * Examples:\n\t *\n\t *     res.send(Buffer.from('wahoo'));\n\t *     res.send({ some: 'json' });\n\t *     res.send('<p>some html</p>');\n\t *\n\t * @public\n\t * @param {string|number|boolean|object|Buffer} body\t\tMessage body to send.\n\t * @return {WebsocketResponse} \t\t\t\t\t\t\t\tFor chaining.\n\t */\n\tsend: function(body) {\n\t\treturn sendMessage(this, createResponseMessage(this, body));\n\t},\n\n\tsendFile: function(path, options, fn) {\n\n\t},\n\n\t/**\n\t * Send given HTTP status code and message.\n\t *\n\t * Sets the response status to `statusCode` and the body of the response to the standard description from node's\n\t * http.STATUS_CODES or the statusCode number if no description.\n\t *\n\t * Examples:\n\t *\n\t *     res.sendStatus(200);\n\t *\n\t * @public\n\t * @param {number} statusCode\t\t\t\t\t\t\t\t\t\t\t\t\t\tCode to send.\n\t * @param {string} [statusMessage=statuses[statusCode] || this.statusMessage]\t\tMessage to send.\n\t * @return {WebsocketResponse} \t\t\t\t\t\t\t\t\t\t\t\t\t\tFor chaining.\n\t */\n\tsendStatus: function(statusCode, statusMessage=statuses[statusCode] || this.statusMessage) {\n\t\tthis.status(statusCode);\n\t\tthis.type('plain/text');\n\t\tthis.send(statusMessage);\n\t},\n\n\t/**\n\t * Set header `field` to `val`, or parse an object of header fields.\n\t *\n\t * Examples:\n\t *\n\t *    res.set('Foo', ['bar', 'baz']);\n\t *    res.set('Accept', 'application/json');\n\t *    res.set({ Accept: 'text/plain', 'X-API-Key': 'tobi' });\n\t *\n\t * @public\n\t * @param {String|Object} field\t\tHeader to set\n\t * @param {String|Array} val\t\tValue to set header to.\n\t * @return {WebsocketResponse} \t\tFor chaining.\n\t */\n\tset: function(field, value) {\n\t\tconst headers = this.headers;\n\t\tif (isObject(field)) {\n\t\t\tObject.keys(field).forEach(header=>{\n\t\t\t\theaders[header] = field[header];\n\t\t\t});\n\t\t} else {\n\t\t\theaders[field] = value;\n\t\t}\n\t},\n\n\t/**\n\t * Set header `field` to `val`, or parse an object of header fields.\n\t *\n\t * Examples:\n\t *\n\t *    res.set('Foo', ['bar', 'baz']);\n\t *    res.set('Accept', 'application/json');\n\t *    res.set({ Accept: 'text/plain', 'X-API-Key': 'tobi' });\n\t *\n\t * @public\n\t * @param {String|Object} field\t\tHeader to set\n\t * @param {String|Array} val\t\tValue to set header to.\n\t * @return {WebsocketResponse} \t\tFor chaining.\n\t */\n\tsetHeader: function(header, value) {\n\t\treturn this.set(header, value);\n\t},\n\n\t/**\n\t * Set status `code`.\n\t *\n\t * @public\n\t * @param {Number} code\t\t\t\tStatus code.\n\t * @return {WebsocketResponse}\t\tFor chaining.\n\t */\n\tstatus: function(code) {\n\t\tthis.statusCode = code;\n\t\tthis.statusMessage = statuses[code];\n\t\treturn this;\n\t},\n\n\t/**\n\t * Set _Content-Type_ response header with `type` through `mime.lookup()` when it does not contain \"/\", or set the\n\t * Content-Type to `type` otherwise.\n\t *\n\t * Examples:\n\t *\n\t *     res.type('.html');\n\t *     res.type('html');\n\t *     res.type('json');\n\t *     res.type('application/json');\n\t *     res.type('png');\n\t *\n\t * @public\n\t * @param {String} type\t\t\t\tMimetype string.\n\t * @return {WebsocketResponse}\t\tFor chaining.\n\t */\n\ttype: function(type) {\n\t\treturn this.set('Content-Type', ((type.indexOf('/') === -1) ? mime.lookup(type) : type));\n\t},\n\n\t/**\n\t * Add `field` to Vary. If already present in the Vary set, then this call is simply ignored.\n\t *\n\t * @public\n\t * @param {Array|String} field\t\tField to vary.\n\t * @return {WebsocketResponse}\t\tFor chaining.\n\t */\n\tvary: function(field) {\n\t\tif (!field || (Array.isArray(field) && !field.length)) {\n\t\t\tdeprecate('res.vary(): Provide a field name');\n\t\t\treturn this;\n\t\t}\n\t\tvary(this, field);\n\t\treturn this;\n\t}\n};\n\nexport class WebsocketResponse {\n\tconstructor(req, client, messageId, type) {\n\t\tdefineProperty(this, ['headers', 'headersSent', 'statusCode', 'statusMessage'], [{}, false, 200, 'Ok']);\n\t\tdefinePropertyFixed(\n\t\t\tthis,\n\t\t\t['locals', 'req', 'app', 'websocketClient'],\n\t\t\t[{}, req, req.app, client]\n\t\t);\n\n\t\trebinder(WebsocketResponseAbstract, this, {methods: Object.keys(WebsocketResponseAbstract)});\n\n\t\tclients.set(this, client);\n\t\tmessageIdIds.set(this, messageId);\n\t\tmessageRecieveType.set(this, type)\n\t}\n}","import ws from 'ws';\r\nimport {handleUpgrade} from './expressWebsocket';\r\nimport {WebsocketRequest as Request} from './request';\r\nimport {WebsocketResponse as Response} from './response';\r\nimport crypto from 'crypto';\r\nimport {getContentLength, makeArray, randomString, isString} from './util';\r\n\r\n\r\nfunction isWebsocket(req) {\r\n\treturn !(\r\n\t\t!!req.websocket ||\r\n\t\t!req.headers ||\r\n\t\t(req.headers.upgrade === undefined) ||\r\n\t\t(req.headers.upgrade.toLowerCase() !== 'websocket')\r\n\t);\r\n}\r\n\r\nfunction parseMessage(rawData) {\r\n\tif (isString(rawData)) {\r\n\t\ttry {\r\n\t\t\treturn ['json', JSON.parse(rawData)];\r\n\t\t} catch(err) {}\r\n\t}\r\n\treturn ['unknown', undefined];\r\n}\r\n\r\nfunction generateMessageId(message, req) {\r\n\tconst shasum = crypto.createHash('sha1');\r\n\tshasum.update(`${message.id}${req.sessionID}`);\r\n\treturn shasum.digest('hex');\r\n}\r\n\r\nfunction handleRequest({message, app, req, client, messageId, type}) {\r\n\tmessage.data.headers = Object.assign(message.data.headers || {}, {\r\n\t\t'Content-Type': 'application/json',\r\n\t\t'Transfer-Encoding': 'identity',\r\n\t\t'Content-Length': getContentLength(message.data.body)\r\n\t});\r\n\r\n\tconst _req = new Request(req, message.data, messageId, client.id);\r\n\tconst _res = new Response(_req, client, message.id, type);\r\n\r\n\tapp.handle(_req, _res);\r\n}\r\n\r\nexport function websocketMiddleware(req, res, next) {\r\n\tif (!isWebsocket(req)) return next();\r\n\r\n\tres.websocket((client, app)=>{\r\n\t\tclient.id = randomString();\r\n\t\tapp.getWebsocketClient = id=>makeArray((app.wss || {}).clients).find(client=>(client.id === id));\r\n\r\n\t\tclient.on('message', rawData=>{\r\n\t\t\tconst [type, message] = parseMessage(rawData);\r\n\r\n\t\t\tif (!!message && !!message.type) {\r\n\t\t\t\tconst messageId = generateMessageId(message, req);\r\n\t\t\t\tif (message.type === 'request') return handleRequest({message, app, req, client, messageId, type});\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\nexport function upgrade(server, app) {\r\n\tconst wss = new ws.Server({noServer:true});\r\n\tserver.on('upgrade', handleUpgrade(app, wss));\r\n\treturn wss;\r\n}"],"names":["handleUpgrade","app","wss","ws","Server","req","socket","upgradeHead","res","http","ServerResponse","assignSocket","head","Buffer","length","copy","on","destroy","websocket","emit","client","cb","Symbol","objectProto","nativeObjectToString","symToStringTag","hasOwnProperty","funcProto","funcToString","HASH_UNDEFINED","Map","Set","chars","split","randomInt","end","start","Math","floor","random","randomString","Array","fill","map","join","getContentLength","message","_isObject","JSON","stringify","toString","err","definePropertyFixed","instance","propertyName","value","forEach","_propertyName","n","Object","defineProperty","isArray","configurable","rebinder","takeFrom","bindTo","methods","method","bind","properties","property","makeArray","undefined","ignoreHeaders","addHeaders","excludeHeader","header","keys","includes","toLowerCase","rawHeadersFactory","filterNext","flatten","headerName","concat","rawHeaders","filter","headers","requestHeadersFactory","_header","toLocaleLowerCase","key","Proxy","target","receiver","Reflect","get","set","has","getOwnPropertyDescriptor","reqHeaders","ownKeys","unique","originalRequests","WeakMap","originalMessages","rebind","getBody","isObject","body","assign","WebsocketRequestAbstract","types","typeis","WebsocketRequest","messageId","wsId","path","secure","EventEmitter","deprecate","depd","clients","messageIdIds","messageRecieveType","createResponseMessage","originalUrl","statusCode","statusMessage","sendMessage","type","send","headersSent","WebsocketResponseAbstract","field","val","prev","filename","extname","contentDisposition","name","options","fn","data","encoding","object","sort","response","callback","links","status","view","locals","statuses","code","indexOf","mime","lookup","WebsocketResponse","isWebsocket","upgrade","parseMessage","rawData","isString","parse","generateMessageId","shasum","crypto","createHash","update","id","sessionID","digest","handleRequest","_req","Request","_res","Response","handle","websocketMiddleware","next","getWebsocketClient","find","server"],"mappings":"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"}